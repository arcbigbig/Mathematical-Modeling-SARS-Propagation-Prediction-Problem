clear;
data1997=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B1:M1');
data1998=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B2:M2');
data1999=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B3:M3');
data2000=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B4:M4');
data2001=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B5:M5');
data2002=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B6:M6');
data2003=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','B7:M7');
t=1:1:12;
figure(1);
plot(t,data1997',t,data1998',t,data1999',t,data2000',t,data2001',t,data2002',t,data2003')
xlabel('月份');ylabel('万人');
legend('1997','1998','1999','2000','2001','2002','2003')
title('北京市各年各月旅游人数图')

zongshu=xlsread('E:\数学建模2022\202207训练题\数据.xlsx','Sheet2','N1:N6');
ty=1997:1:2002;
figure(2);
plot(ty,zongshu);
xlabel('年');ylabel('万人');
title('北京市各年旅游总人数图')

figure(3);
newdata=[data1997,data1998,data1999,data2000,data2001,data2002];
tq=1:1:72;
tw=1:1:84
p=polyfit(tq,newdata,1);
T=polyval(p,tw);
plot(tq,newdata,tw,T);
xlabel('月份');ylabel('万人');
title('北京市72个月时间里旅游人数折线图')

r1=mean(newdata(1:12:length(newdata)));%每隔4个点取第一个点
r2=mean(newdata(2:12:length(newdata)));%每隔4个点取第2个点
r3=mean(newdata(3:12:length(newdata)));%每隔4个点取第3个点
r4=mean(newdata(4:12:length(newdata)));%每隔4个点取第4个点
r5=mean(newdata(5:12:length(newdata)));%每隔4个点取第一个点
r6=mean(newdata(6:12:length(newdata)));%每隔4个点取第2个点
r7=mean(newdata(7:12:length(newdata)));%每隔4个点取第3个点
r8=mean(newdata(8:12:length(newdata)));%每隔4个点取第4个点
r9=mean(newdata(9:12:length(newdata)));%每隔4个点取第一个点
r10=mean(newdata(10:12:length(newdata)));%每隔4个点取第2个点
r11=mean(newdata(11:12:length(newdata)));%每隔4个点取第3个点
r12=mean(newdata(12:12:length(newdata)));%每隔4个点取第4个点
r=[r1,r2,r3,r4,r5,r6,r7,r8,r9,r10,r11,r12];

R1=mean(T(1:12:length(T)));%每隔4个点取第一个点
R2=mean(T(2:12:length(T)));%每隔4个点取第2个点
R3=mean(T(3:12:length(T)));%每隔4个点取第3个点
R4=mean(T(4:12:length(T)));%每隔4个点取第4个点
R5=mean(T(5:12:length(T)));%每隔4个点取第一个点
R6=mean(T(6:12:length(T)));%每隔4个点取第2个点
R7=mean(T(7:12:length(T)));%每隔4个点取第3个点
R8=mean(T(8:12:length(T)));%每隔4个点取第4个点
R9=mean(T(9:12:length(T)));%每隔4个点取第一个点
R10=mean(T(10:12:length(T)));%每隔4个点取第2个点
R11=mean(T(11:12:length(T)));%每隔4个点取第3个点
R12=mean(T(12:12:length(T)));%每隔4个点取第4个点
R=[R1,R2,R3,R4,R5,R6,R7,R8,R9,R10,R11,R12];

k=r./R;
K=12/sum(k)*k;
t1=73:1:84;%预测
yuce=polyval(p,t1);
Y=K.*yuce;
figure(4);
plot(tq,newdata,tw,T,t1,Y,'-*');
legend('真实数据','大致趋势','2003预测数据')
xlabel('月份');ylabel('万人');
title('北京市84个月时间里旅游人数折线图')

figure(5);
plot(1:1:12,data2003,'-o',1:1:12,Y,'-*');
legend('真实数据','2003预测数据');
xlabel('月份');ylabel('万人');